---
layout: post
title: "日志清除的shell小脚本"
description: ""
category: 程序设计
subtitle:
author: "fishcried"
header-img: "img/bg/home-bg.jpg"
tags: [shell,日志]
---

	#!/bin/env bash
	#
	# The MIT License (MIT)
	# Copyright (c) 2014 fishcried(tianqing.w@gmail.com)
	#
	# cleanup log files(message, wtmp
	
	LOG_DIR=/var/log
	ROOT_UID=0      # Only user with $UID 0 have root privileges.
	LINES=50        # Default number of lines saved.
	E_XCD=86        # Can't change directory?
	E_NOTROOT=87    # Non-root exit error.
	E_WRONGARGS=85  # Non-numberical arguments, bad argument format
	
	# Run as root, of course.
	if [ "$UID" -ne "$ROOT_UID" ]; then
	        echo "Must be root to run this script"
	        exit $E_NOTROOT
	fi
	
	# check the argument
	case "$1" in
	        "")    lines=$LINES
	                ;;
	        *[!0-9]*) echo "Usage: $(basename $0) file-to-cleanup"
	                exit $E_WRONGARGS
	                ;;
	        *)     lines=$1
	                ;;
	esac
	        
	cd $LOG_DIR || {
	        echo "Cannot change to necessary directory." >&2
	        exit $E_XCD
	}
	
	tail -n $lines message > mesg.tmp
	mv mesg.tmp message
	cat /dev/null > wtmp
	echo "Logs cleaned up"
	
	exit 0

# 修改记录 

|Why | Who | When |
|----|-----|------|
|翻出来的,不知道什么时候的了|fishcired|2014-07-12 |
